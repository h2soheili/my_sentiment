from tokenizers import Tokenizer, Regex
from tokenizers.models import BPE
from tokenizers.normalizers import Sequence as NormalizerSequence, Replace, BertNormalizer, Strip
from tokenizers.pre_tokenizers import Whitespace
from tokenizers.trainers import BpeTrainer

corpus_files = ["../data/text2.txt"]

special_tokens = [
    "<|begin_of_text|>",
    "<|end_of_text|>",
    "<|padding_token|>",

    "%", "$", "€", "£",

    "تریلیون", "همت", "میلیارد", "میلیون", "هزار", "تومان", "ریال", "نرخ", "گزارش", "روند", "صعودی", "نزولی",
    "خرید", "فروش", "سهامی", "سهام", "سهم", "شرکت", "نماد", "صنعت", "فرابورس", "بورس", "کاهشی", "افزایشی", "کاهش",
    "افزایش", "پایه", "قیمت", "معامله", "معاملات", "سالانه", "ساله", "سال", "ماهانه", "ماهه", "ماه", "صورت مالی",
    "مالی", "تن", "کیلو", "گرم", "لیتر", "متر مکعب", "متر مربع", "متر", "وزن", "حجم", "شمش", "طلا", "سکه", "نفت", "گاز",
    "بهره", "سود", "زیان", "حقوقی", "حقیقی", "هکتار", "مبلغ", "ارز", "عرضه", "تقاضا", "حواله", "پول", "صندوق",
    "گازوییل", "بنزین",

    "شنبه", "یکشنبه", "دوشنبه", "سه شنبه", "چهار شنبه", "پنچشنبه", "جمعه",

    "january", "february", "march", "april", "may", "juan", "july",
    "july", "august", "september", "october", "november", "december",

    "فروردین", "اردیبهشت", "خرداد", "تیر", "مرداد", "شهریور",
    "مهر", "آبان", "آذر", "دی", "بهمن", "اسفند",

    'آباد', 'آبادا', 'آپ', 'آسیا', 'اپال', 'اتکام', 'اخابر', 'اردستان', 'اسیاتک', 'افق', 'البرز',
    'امید', 'امین', 'انرژی', 'بالبر', 'بترانس', 'برکت', 'بسویچ', 'بشهاب', 'بفجر', 'بکاب', 'بکام',
    'بموتو', 'بنیرو', 'بورس', 'بوعلی', 'پارس', 'پارسان', 'پارسیان', 'پاسا', 'پاکشو', 'پتایر', 'پترول', 'پدرخش',
    'پردیس', 'پسهند', 'پکرمان', 'پکویر', 'پلاسک', 'پی پاد', 'تاپیکو', 'تایرا', 'تپمپی', 'تکاردان', 'تکمبا',
    'تکنو', 'تملت', 'تنوین', 'تیپیکو', 'ثاخت', 'ثامان', 'ثامید', 'ثبهساز', 'ثشاهد', 'ثشرق', 'ثفارس',
    'ثمسکن', 'ثنوسا', 'جم', 'جم پیلن', 'چافست', 'چدن', 'چفیبر', 'چکاپا', 'چکارن', 'چکاوه', 'حپترو', 'حتاید',
    'حتوکا', 'حفارس', 'حفاری', 'حکشتی', 'خاذین', 'خاهن', 'خبهمن', 'خپویش', 'ختراک', 'ختور', 'ختوقا',
    'خچرخش', 'خراسان', 'خریخت', 'خرینگ', 'خزامیا', 'خزر', 'خساپا', 'خشرق', 'خفنر', 'خکار', 'خکمک', 'خگستر',
    'خلنت', 'خمحرکه', 'خمحور', 'خمهر', 'خنصیر', 'خودرو', 'خوساز', 'دابور', 'داتام', 'دارو', 'داسوه',
    'دالبر', 'دامین', 'دانا', 'دپارس', 'دتماد', 'دجابر', 'ددام', 'درازک', 'دروز', 'دزهراوی', 'دسبحا', 'دسبحان',
    'دسینا', 'دشیمی', 'دعبید', 'دفارا', 'دفرا', 'دکوثر', 'دکیمی', 'دلر', 'دلقما', 'دیران', 'ذوب',
    'رانفور', 'رتاپ', 'رکیش', 'رمپنا', 'زپارس', 'زکوثر', 'زمگسا', 'سآبیک', 'ساراب', 'ساربیل', 'ساروم',
    'سبجنو', 'سبهان', 'سپ', 'سپاها', 'سپید', 'ستران', 'سخاش', 'سخزر', 'سخوز', 'سدشت', 'سدور', 'سرود', 'سشرق',
    'سشمال', 'سصفها', 'سصوفی', 'سغرب', 'سفار', 'سفارس', 'سفانو', 'سقاین', 'سکرد', 'سکرما', 'سمازن',
    'سنیر', 'سهرمز', 'سهگمت', 'سیتا', 'سیدکو', 'سیستم', 'سیلام', 'سیمرغ', 'شاراک', 'شاملا', 'شبریز',
    'شبندر', 'شبهرن', 'شپارس', 'شپاکسا', 'شپدیس', 'شپنا', 'شتران', 'شخارک', 'شدوص', 'شراز', 'شسپا', 'شستا',
    'شسینا', 'شغدیر', 'شفا', 'شفارس', 'شفن', 'شکربن', 'شکلر', 'شگل', 'شلعاب', 'شنفت', 'شهر', 'شوینده',
    'شیراز', 'شیران', 'صبا', 'غاذر', 'غالبر', 'غبشهر', 'غبهنوش', 'غپاک', 'غپینو', 'غچین', 'غدام', 'غدشت', 'غزر',
    'غسالم', 'غشاذر', 'غشان', 'غشصفا', 'غشهد', 'غکورش', 'غگرجی', 'غگل', 'غمهرا', 'غنوش', 'فاذر',
    'فاراک', 'فارس', 'فاسمین', 'فاما', 'فایرا', 'فباهنر', 'فپنتا', 'فجام', 'فجر', 'فخاس', 'فخوز',
    'فرآور', 'فروس', 'فسازان', 'فسبزوار', 'فسپا', 'فسرب', 'فلامی', 'فلوله', 'فمراد', 'فملی', 'فنوال', 'فنورد',
    'فولاد', 'فولاژ', 'قپیرا', 'قثابت', 'قرن', 'قزوین', 'قشکر', 'قشهد', 'قصفها', 'قلرست', 'قمرو', 'قنیشا',
    'قهکمت', 'کاذر', 'کالا', 'کاما', 'کاوه', 'کبافق', 'کپارس', 'کپشیر', 'کترام', 'کچاد', 'کحافظ',
    'کخاک', 'کدما', 'کرازی', 'کرماشا', 'کروی', 'کساپا', 'کساوه', 'کسرا', 'کسرام', 'کسعدی', 'کطبس', 'کفپارس', 'کفرا',
    'کگاز', 'کگل', 'کلوند', 'کماسه', 'کمنگنز', 'کنور', 'کهمدا', 'کویر', 'کیمیا', 'کیمیاتک', 'لابسا',
    'لبوتان', 'لپارس', 'لخزر', 'لسرما', 'لوتوس', 'ما', 'مبین', 'مداران', 'ملت', 'میدکو', 'نمرینو', 'نوری',
    'های وب', 'همراه', 'وآذر', 'وآفری', 'واتی', 'واعتبار', 'والبر', 'وامید', 'وایران', 'وبانک', 'وبشهر',
    'وبصادر', 'وبملت', 'وبهمن', 'وبوعلی', 'وبیمه', 'وپارس', 'وپاسار', 'وپترو', 'وپخش', 'وپست', 'وتجارت', 'وتوس',
    'وتوسم', 'وتوشه', 'وتوصا', 'وتوکا', 'وخارزم', 'وخاور', 'ورنا', 'وساپا', 'وساخت', 'وساربیل',
    'وساشرقی', 'وساغربی', 'وسبوشهر', 'وسپه', 'وسخراج', 'وسخراش', 'وسخوز', 'وسرضوی', 'وسزنجان', 'وسصفا',
    'وسفارس', 'وسقم', 'وسکاب', 'وسکرد', 'وسکرشا', 'وسکرمان', 'وسکهبو', 'وسگلستا', 'وسگیلا', 'وسلرستا', 'وسمازن',
    'وسمرکز', 'وسهرمز', 'وسهمدا', 'وسیزد', 'وسیستا', 'وسیلام', 'وسینا', 'وصنا', 'وصندوق', 'وصنعت',
    'وغدیر', 'وکار', 'وکغدیر', 'ولپارس', 'ولساپا', 'ولصنم', 'ولغدر', 'ولکار', 'ولملت', 'ومدیر', 'ومعادن',
    'وملی', 'ومهان', 'ونفت', 'ونوین', 'ونیرو', 'ونیکی', 'آ س پ', 'آردینه', 'آریا', 'آریان', 'اپرداز', 'اتکای',
    'ارفع', 'اعتلا', 'افرا', 'انتخاب', 'اوان', 'بالاس', 'بپاس', 'بپیوند', 'بجهرم', 'بخاور', 'بزاگرس',
    'بساما', 'بکابل', 'بکهنوج', 'بگیلان', 'بمپنا', 'بمولد', 'بنو', 'بهپاک', 'بیوتیک', 'پارتا', 'پخش',
    'پیزد', 'تاپکیش', 'تبرک', 'تپسی', 'تجلی', 'تلیسه', 'تماوند', 'توریل', 'توسن', 'ثالوند', 'ثباغ',
    'ثپردیس', 'ثتران', 'ثجنوب', 'ثرود', 'ثعمرا', 'ثغرب', 'چخزر', 'حآسا', 'حآفرین', 'حپارسا', 'حپرتو',
    'حخزر', 'حریل', 'حسیر', 'حسینا', 'حگهر', 'خاور', 'خدیزل', 'خکرمان', 'خنور', 'داوه', 'دبالک',
    'دتوزیع', 'دتولید', 'ددانا', 'درازی', 'درهآور', 'دسانکو', 'دقاضی', 'دکپسول', 'دماوند', 'رافزا',
    'رنیک', 'ریشمک', 'زاگرس', 'زبینا', 'زدشت', 'زشریف', 'زشگزا', 'زفجر', 'زفکا', 'زقیام', 'زکشت', 'زگلدشت',
    'زماهان', 'زملارد', 'زنگان', 'ساروج', 'سامان', 'ساوه', 'ساینا', 'سبزوا', 'سپیدار', 'سجام', 'سدبیر', 'سرچشمه',
    'سغدیر', 'سمگا', 'شاروم', 'شاوان', 'شبصیر', 'شپاس', 'شتوکا', 'شجم', 'شرانل', 'شصدف', 'شفام', 'شکام',
    'شگویا', 'شملی', 'عالیس', 'غپآذر', 'غپونه', 'غدانه', 'غدیس', 'غشهداب', 'غصینو', 'غفارس', 'غگلپا',
    'غگلستا', 'غگیلا', 'غمایه', 'غمینو', 'غویتا', 'فالوم', 'فتوسا', 'فجهان', 'فرابورس', 'فرود', 'فروژ',
    'فروسیل', 'فروی', 'فزر', 'فزرین', 'فسوژ', 'فصبا', 'فغدیر', 'فگستر', 'فن افزار', 'فنر', 'فولای',
    'قاسم', 'قچار', 'قشیر', 'کاسپین', 'کایزد', 'کپرور', 'کتوسعه', 'کتوکا', 'کرمان', 'کرومیت', 'کزغال',
    'کشرق', 'کگهر', 'کلر', 'کمرجان', 'کوثر', 'کی بی سی', 'گدنا', 'گکوثر', 'گلدیرا', 'گوهران', 'لطیف', 'مادیرا',
    'مارون', 'مدیریت', 'معین', 'مفاخر', 'میهن', 'ناما', 'نخریس', 'نطرین', 'نوین', 'نیان', 'هجرت',
    'هرمز', 'وآوا', 'والماس', 'وامین', 'وپویا', 'وتعاون', 'ودی', 'وسبحان', 'وسپهر', 'وطوبی', 'وکبهمن',
    'وگردش', 'وگستر', 'ولبهمن', 'ولتجار', 'ولشرق', 'ومعلم', 'وملل', 'وهامون', 'وهور', 'شتهران', 'کارام', 'کازرو',
    'ممسنی', 'شلرد', 'وشمال', 'زنجان', 'غمارگ', 'تکیمیا', 'وبرق', 'استقلال', 'پرسپولیس', 'نیرو', 'سنوین',
    'آینده', 'تفارس', 'ودانا', 'بمیلا', 'تکنار', 'داراب', 'فسا', 'جهرم', 'حرهشا', 'بپردیس', 'سخواف',
    'آرمان', 'حاریا', 'فلات', 'وکادو', 'غشوکو', 'سکارون', 'شمواد', 'حبندر', 'شپلی', 'ولراز', 'ورازی',
    'ثعتما', 'ویسا', 'ثنظام', 'وزمین', 'دی', 'دحاوی', 'ثجوان', 'کمینا', 'کباده', 'وآفر', 'واحصا',
    'واحیا', 'سفاسی', 'وملت', 'خکاوه', 'تشتاد', 'وفتخار', 'گکیش', 'جوین', 'فبیرا', 'لکما', 'وثوق',
    'کابگن', 'لازما', 'پلاست', 'قجام', 'بایکا', 'غیوان', 'لپیام', 'غناب', 'وامیر', 'قنقش', 'سمایه', 'خصدرا',
    'شفارا', 'وثنو', 'کهرام', 'وسالت', 'گنگین', 'فنفت', 'قیستو', 'شلیا', 'قشرین', 'وهنر', 'شزنگ', 'کایتا',
    'لخانه', 'ثاژن', 'وشهر', 'خبازرس', 'ومشان', 'ثنور', 'ثقزوی', 'سپرمی', 'ساذری', 'سایرا', 'چنوپا', 'ولانا',
    'سباقر', 'سمتاز', 'تپکو', 'فجوش', 'دتهران', 'وآیند', 'وسرمد', 'وسنا', 'باران', 'وارس', 'رتکو', 'وآتوس',
    'نبروج', 'ولیز', 'تمحرکه', 'فبستم', 'وحافظ', 'وثخوز', 'ولقمان', 'قتربت', 'تاتمس', 'خبنیان',
    'بازرگام', 'سفارود', 'فکمند', 'نتوس', 'وسدید', 'شتولی', 'ثزاگرس', 'خلیبل', 'وسین', 'وتوسکا', 'فافزا', 'خودکفا',
    'شکف', 'کفرآور', 'فافق', 'حشکوه', 'بهیر', 'خفولا', 'حگردش', 'تپولا', 'قاروم', 'گپارس', 'وایرا', 'کاریز',
    'ثتوسا', 'فاهواز', 'وجامی', 'آبین', 'شکبیر', 'دهدشت', 'معیار', 'وحکمت', 'خعمرا', 'دشیری', 'کیسون',
    'وپسا', 'بتک', 'شستان', 'شساخت', 'خفناور', 'سلار', 'فسدید', 'پشاهن', 'کقزوی', 'اتکاسا', 'غبهار',
    'وآرین', 'ثنام', 'شپترو', 'ثاصفا', 'شسم', 'پلوله', 'کورز', 'گشان', 'نشار', 'تفیرو', 'رفاه', 'تابا',
    'فوکا', 'خپارس', 'بتهران', 'فنرژی', 'وفردا', 'پرداخت', 'تاصیکو', 'خموتور', 'تکشا',

]

tokenizer = Tokenizer(BPE())

tokenizer.normalizer = NormalizerSequence([
    Strip(),
    BertNormalizer(clean_text=True, strip_accents=True, lowercase=True),
    Replace(Regex("\s{2,}"), " "),
])

tokenizer.pre_tokenizer = Whitespace()

tokenizer.add_special_tokens(special_tokens)

trainer = BpeTrainer(
    special_tokens=special_tokens,
    vocab_size=3500,
    min_frequency=20,
    show_progress=True,
    max_token_length=20,
)

print("started...")
tokenizer.train(files=corpus_files, trainer=trainer)
tokenizer.save("./example_tokenizer.json")
print("...end")
# print(len(tokenizer))
